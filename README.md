以下に自分が行ってきたプロジェクトについてまとめています。

https://note.com/cozy_rue318

↑noteにて活動を始めました！よろしければ見ていただきたいです。これからセキュリティやツール開発など幅広く発信していくつもりです！

### **1. Wi-Fiセキュリティ（WPA/WPA2）の脆弱性に関する実証的検証**

#### **背景と目的**

警察庁の統計によると、不正アクセス行為の手口として「利用権者のパスワードの設定・管理の甘さにつけこんだもの」が常に高い割合を占めています。この社会的な課題に対し、WPA/WPA2における安易なパスワード設定が、具体的にどのような技術的脅威に晒されるのかを実証的に示すことを目的としました。

#### **実験環境と手法**

* **環境構築:** 攻撃者端末として**Kali Linux**を、標的として複数のテスト用AP（SSID: `Free_Wi-Fi`等）をWPA-PSKで設定した、クローズドな無線LAN環境を構築。
* **攻撃手法（4-way Handshake Attack）：**
    1.  `airodump-ng`で標的APに接続するクライアントを偵察。
    2.  `aireplay-ng`でクライアントに認証解除パケットを送信し、再接続時の4-way handshakeをキャプチャ。
    3.  `aircrack-ng`とパスワードリスト（`rockyou.txt`等）を用いたオフラインでの**辞書攻撃**を実行。

#### **成果と学び**

* **成功事例：** パスワードが`12345678`に設定されたAPのパスワード解読に成功。この結果は、数字のみで構成された短いパスワードがいかに脆弱であるかを明確に示しています。
* **結論：** この実験は、不正アクセスの主要な原因の一つが、技術的なシステムの脆弱性だけでなく、**人間側のパスワード管理の甘さ**にあるという統計的事実 を、技術的に裏付けるものでした。攻撃者の視点を体験することで、パスワードの複雑化や定期的な変更といった、基本的な防御策の重要性を深く学びました。

---

### **2. フィッシングサイトの分析と社会背景の考察**

#### **背景と目的**

近年、**インターネットバンキングでの不正送金**や、**フィッシングサイト**経由での識別符号詐取が社会問題化しています。自身が受信したフィッシングメールを教材に、その手口を分析し、社会的な脅威への理解を深めることを目的としました。

#### **調査手法**

* 国税庁を騙るフィッシングサイトのURLを、セキュリティツール「gredでチェック」を用いて評価。
* サイトが「フィッシング」の疑いがある危険なサイトとして判定されることを確認。

#### **成果と学び**

* 不正アクセス後の行為として、インターネットバンキングでの不正送金額が令和元年以降、年間1800件以上と高水準で推移している統計データ と、フィッシングによる識別符号詐取が令和2年に急増しているデータ を確認。
* これらのデータと、自身が受信したフィッシングメールという実例を結びつけることで、**統計上のマクロな脅威**が、いかに**個人レベルのミクロな危機**に直結しているかを体感的に理解しました。


# フィッシングドメイン監視・分析ツール

このプロジェクトでは、実際に受信したフィッシングメールに基づいて、不正ドメインの監視・分析を行うPythonスクリプトを開発・運用した記録と成果をまとめています。

---

## 背景と目的

2025年7月8日、GMOあおぞらネット銀行を偽装した**フィッシングメール**を受信しました。  
メール内リンクは短縮URL（t.co）を経由し、不審なドメイン（`gmkortodontia.com` および `jzxyyq.com`）へリダイレクトされていました。これらは銀行公式サイトを模したログイン画面を装っており、フィッシング詐欺の可能性が極めて高いと判断しました。

被害拡大を防ぐとともに、セキュリティ技術の実践として、以下のような**自作ツールによる監視・レポート作成**に取り組みました。

---

## 実装機能一覧

- WHOIS 情報の取得（登録者情報・国・更新日・有効期限）
- SSL/TLS 証明書の発行元・有効期限チェック
- HTTP ステータス確認（例: 200 / 404 / 302）
- 各種情報を Markdown 形式で自動レポート出力
- 新規に追加されたドメインを自動検出し、差分を記録

---

## レポート出力サンプル（抜粋）

ドメイン: gmkortodontia.com
IPアドレス: 137.220.227.153

HTTPステータス: 404

WHOIS更新日: 2025-07-07

WHOIS登録者: Redacted for privacy（JP）

SSL発行者: Let's Encrypt

SSL有効期限: 2025年10月5日

ドメイン: jzxyyq.com
IPアドレス: 137.220.202.232

HTTPステータス: 404

WHOIS登録者: REDACTED FOR PRIVACY（NL）

WHOISメール: abuse@metaregistrar.com / complaint@gname.com

---

## 使用技術・ライブラリ

- 言語: Python 3.13.5
- ライブラリ:  
  - `requests`  
  - `socket`  
  - `ssl`  
  - `whois`（Python版）  
  - `datetime`  
  - `OpenSSL`  

---

## 学びと活用可能性

- フィッシング詐欺を対象に、**ドメイン調査から技術的検証、文書化、報告まで**を一貫して実施
- **情報セキュリティコンサルティング**や**SOC業務**で重要な「OSINT（公開情報収集）」の実践経験
- 監視業務を支える技術（監視スクリプト、定期実行、自動レポート作成）を実地で構築・運用

---

## 今後の展望

- Levenshtein距離や類似文字列マッチを用いた**類似ドメインの自動検出**
- GitHub Actions による**定期監視・レポート更新の自動化**
- Google Safe Browsing・レジストラ・URL短縮サービスなどへの**自動通報スクリプト**
- ポートスキャンや地理的IPトレースなど**合法的範囲での加害者調査支援**

---

## 注意事項

本プロジェクトでは、**すべて公開情報（WHOIS / DNS / SSL情報等）を用いて調査を行っています**。  
違法行為や誹謗中傷、リベンジ目的での使用は一切行っておらず、セキュリティ啓発・教育目的の範囲に限定しています。

以上が実際に自分に届いたフィッシングメールをもとに考案したプロジェクトです。

# 📊 自作Googleスプレッドシート WBS管理ツール（ガントチャート・EVM付き）

## 概要

このGoogle Apps Script（GAS）は、Googleスプレッドシート上で**WBS（Work Breakdown Structure）**を管理するためのツールです。
WBSに入力された作業情報をもとに、**自動的にIDを割り振り**、**ガントチャートの描画**や**EVM（Earned Value Management）指標の算出**を行います。
また、作業の進捗状況や変更内容に応じて、**担当者にメール通知**を送る機能も備えています。

---

## 🔧 主な機能

### ✅ WBS入力支援

* 自動ID割り当て（作業名・日付・担当者などが揃ったら発番）
* 進捗100%で自動的に行が緑色に
* 優先度に応じてセルの色分け
* サンプルタスク（ID: `0`）付きで初期構成済み

### 🔍 タスク検索機能

* `W2`セルにIDまたは作業名を入力すると該当行へジャンプ
* プレースホルダ表示によるUXの向上

### 📧 担当者への通知メール送信

* 進捗変更・担当者変更・期限変更・内容変更などを通知
* `TARGET_ASSIGNEES_MAP`で名前とメールアドレスを一元管理

### 📅 ガントチャート自動描画

* `Gantt_Chart`シートに週始まりで表示
* 日別にバーで可視化し、進捗100%のタスクを色分け

### 📈 EVM（Earned Value Management）指標計算

* `EVM_Display`シートでPV（予定）、EV（出来高）、AC（実績）を計算
* SPI、CPIを算出し、プロジェクトの健全性を把握

### 🧾 How\_To\_Use シート付き

* 操作マニュアルを自動生成（初めてのユーザーでも安心）

---

## 📂 シート構成

| シート名          | 役割                         |
| ------------- | -------------------------- |
| `WBS_Data`    | 作業情報の入力・管理（ID、作業名、進捗、期日など） |
| `Gantt_Chart` | 作業期間に基づくガントチャートの自動描画       |
| `EVM_Display` | EVM指標とグラフの表示               |
| `How_To_Use`  | 使い方マニュアル（自動生成）             |

---

## 🚀 初期セットアップ手順

1. Googleスプレッドシートを作成
2. スクリプトエディタを開く（`拡張機能 > Apps Script`）
3. このリポジトリのコードを貼り付けて保存
4. `createInitialSheets()` を一度だけ実行
5. 初期シート・サンプルデータ・HowTo説明が生成されます

---

## 🧠 使い方のポイント

* IDは自動で付与されます。**手動で変更しないでください。**
* 必須項目（作業名・開始日・終了日・予定時間・担当者）を入力するとIDが付与されます。
* `WBS管理`メニューからガントチャート・EVMの手動更新も可能です（自動でも更新されます）。
* 担当者のメールアドレスは `TARGET_ASSIGNEES_MAP` 内で管理してください。
* 検索ボックス（`W2`セル）を使えばすぐにタスクを探せます。

---

## 📬 通知の対象となる編集

* 担当者の変更
* 進捗度の更新（100%達成時を含む）
* 実績作業時間の変更
* 開始日・終了日・優先度などの主要項目の変更

---

## ⚠️ 注意点

* ガントチャートは**週の月曜日**から始まります。
* EVMの計算には予定作業時間・実績作業時間・進捗度 (%)が必要です。
* ID「0」はサンプル専用。実データには使用しないでください。
* 通知メールの送信にはスクリプトの**Gmail送信権限**が必要です。

---

## 🛠 依存ライブラリ・外部サービス

* **Google Apps Script（標準機能のみ）**
* **MailApp**: 担当者通知メール送信
* **Logger**: デバッグ用ログ出力

---

## 📅 EVM計算式

| 指標                | 計算式                  |
| ----------------- | -------------------- |
| PV（Planned Value） | 予定作業時間               |
| EV（Earned Value）  | 予定作業時間 × (進捗度 / 100) |
| AC（Actual Cost）   | 実績作業時間               |
| SPI（進捗率）          | EV / PV              |
| CPI（コスト効率）        | EV / AC              |

---

## 💡 カスタマイズ例

* ガントチャートのバーを「■」から色付きセルに変える
* `How_To_Use`の内容をチームごとに編集
* メール送信のタイミングや文言を柔軟に変更

---

## 🧑‍💻 作者・連絡先

文教大学 情報学部 情報システム学科
WBS管理ツール開発者(自分)

以上がプロジェクト演習の際に自作したツールです。Redmineを参考に少しアレンジしてみました。

-----

# CYBER-AEGIS: An Autonomous, Self-Evolving Cyber Security Ecosystem

![Python](https://img.shields.io/badge/python-3.13+-blue.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)

---

### 1. なぜこのプロジェクトを作ったのか (Motivation)

現代のサイバーセキュリティは、堅牢な城壁を築くだけの「静的な防御」では不十分だと感じていました。日々進化する脅威は、城壁の穴を探す攻城兵器ではなく、城の中に忍び込み、内部から崩壊させる諜報員（スパイ）に近い存在です。ならば、私たちのPCにも、常に内部の防衛能力をテストし、弱点を探し出し、共に成長してくれるインテリジェントな「スパーリング・パートナー」が必要ではないか？

この着想から、**CYBER-AEGIS**の開発は始まりました。このプロジェクトは、AIと人間が協働することで、ユーザー一人ひとりの環境に最適化され、自ら学習・進化を続ける、全く新しいパーソナル・セキュリティの形を追求したものです。

### 2. プロジェクト概要 (Overview)

**CYBER-AEGIS**は、個人のPCを包括的に保護するために設計された、自律型の**統合セキュリティオペレーション(SecOps)プラットフォーム**です。本システムは、外部の脅威情報をリアルタイムで収集・分析する「Orion脅威インテリジェンスエンジン」**と、ユーザー自身の環境の脆弱性を発見・学習する**「Trinity AIシミュレーションエンジン」という2つのエンジンを搭載しています。これら2つのエンジンが連携することで、既知の脅威に対する防御と、未知の脅威に対する予測的・能動的な防御の両方を、単一のプラットフォームで実現します。

### 3. システムアーキテクチャ (System Architecture)

| レイヤー | コンポーネント | 主要機能 |
| :--- | :--- | :--- |
| **LAYER 3:<br/>User Interface & Control** | **Dashboard (GUI)** | AI Security Advisor、インテリジェンスビュー、Trinity AI演習、各種監視状況の可視化と操作 |
| ▲<br/>**`Data Flow`**<br/>▼ | | |
| **LAYER 2:<br/>Analysis, Intelligence & Action** | **Orion Engine**<br/>(Threat Intelligence) | ・AIによる脅威分析と助言<br/>・Sigma/YARAルールによるスキャン<br/>・能動的脆弱性スキャン |
| | **Trinity AI Engine**<br/>(Self-Evolving Simulation) | ・PC環境の動的プロファイリング<br/>・AIによる防衛ルールの自動構築<br/>・AI同士による自律的なサイバー演習 |
| ▲<br/>**`Data Flow`**<br/>▼ | | |
| **LAYER 1:<br/>Data Collection & Monitoring** | **External Collectors** | SNS (Discord, X), OSINT (GitHub, Pastebin), CISA KEVなどの外部脅威情報を収集 |
| | **Internal Monitors** | ネットワーク、ファイルシステム、OSログなど、PC内部のアクティビティをリアルタイムで監視 |

### 4. 主な特徴 (Key Features)

CYBER-AEGISは、以下の多岐にわたる専門的な機能を、一つの統合されたダッシュボードから提供します。

#### **外部脅威インテリジェンス (External Threat Intelligence)**
* **SNS監視:** Discord、X (旧Twitter)などから、機密情報の漏洩や新たな脅威に関する投稿をリアルタイムで収集。
* **OSINTツール統合:** GitHub、Pastebinといったプラットフォームを監視し、漏洩したコードや認証情報を検出。
* **プロフェッショナルな脅威情報:** CISA KEV（悪用が確認された脆弱性リスト）など、信頼性の高い情報源からデータを自動で取り込み、ユーザー環境との関連性を分析。

#### **内部システム監視 (Internal System Monitoring)**
* **ネットワーク監視:** 不審なIPアドレスへの通信や、通常とは異なるポートのスキャン活動をリアルタイムで検知・警告。
* **ファイル監視:** 重要なフォルダでファイルが作成・変更・削除された際に、その操作を記録し、不審な場合はアラートを生成。
* **ログ監視:** Windowsのイベントログなどを継続的に監視し、セキュリティ侵害の兆候を早期に発見。

#### **脆弱性スキャン (Proactive Vulnerability Scanning)**
* **Hephaestus Scanner:** システムにインストールされているソフトウェアのバージョン情報などを基に、既知の脆弱性が存在しないかをスキャンし、報告。

#### **AIによる分析と相関 (AI-Powered Analysis & Correlation)**
* **AI Security Advisor:** 上記の全ての監視・収集データを統合し、AIがその重要度と緊急度を評価。「今、最も注意すべき脅威は何か」を自然言語でユーザーに助言。
* **Sigma & YARA:** 業界標準の脅威検出ルール（Sigma/YARA）を用いて、ログやファイルから高度な攻撃の痕跡を検出。
* **AIレポート出力機能:** 複雑な分析結果や演習の戦闘記録を、AIが人間が理解しやすい詳細なレポートとして自動生成。

#### **自律型AIサイバー演習 (Autonomous AI Cyber Exercises)**
* **Trinity AI Engine:** 本システムの最も革新的な機能。ユーザーのPC環境（デジタルツイン）を舞台に、7体の専門家AI（偵察、分析、監督、攻撃、防御など）が連携し、完全に自律的なサイバー演習（レッドチーム vs ブルーチーム）を実行。これにより、標準的なセキュリティソフトでは見つけられない、**ユーザー固有の弱点**を発見し、報告する。

#### **アーキテクチャ**
* **完全なローカル依存:** AIモデル（Ollama）からデータベースまで、全ての機能がユーザーのローカルマシン上で完結。クラウドへの依存をなくし、プライバシーと堅牢性を最大化。
* **他のセキュリティソフトとの共存:** 主に監視とシミュレーションを行うため、`ESET`や`Norton`といった既存のセキュリティ製品と競合することなく、共存して使用可能。

### 5. 実行に必要な環境 (Prerequisites)

本システムは、AIモデルの実行環境として**Ollama**に依存しています。使用前に、以下の準備が必要です。

1.  **Ollamaのインストール:**
    [Ollama公式サイト](https://ollama.com/)から、お使いのOSに合ったアプリケーションをダウンロードし、インストールしてください。

2.  **AIモデルのダウンロード:**
    Ollamaをインストール後、コマンドプロンプトやターミナルで以下のコマンドを実行し、本システムが使用するAIモデルをダウンロードしてください。
    ```bash
    ollama pull gemma2:latest
    ollama pull gemma3:latest
    ```

### 6. 主な使用技術 (Tech Stack)

* **Backend:** Python 3.13+
* **AI:** Ollama (Local LLM)
* **GUI:** PyQt6
* **Database:** SQLAlchemy, SQLite
* **Key Libraries:** Pandas, Requests, Watchdog, Scapy, Yara-python, etc.

### 7. 今後の展望 (Future Outlook)
* **自己進化ループの実装:** Trinity AI Engineが演習で生成した「自己進化コード」を、次回の演習の防御ロジックに自動で組み込む、完全な自己進化ループを完成させる。
* **脅威インテリジェジェンスの深化:** アナリストAIに、より多様な情報源を調査させ、構築する防御ルールの精度と信頼性をさらに高める。
* **アーキテクチャの選択肢:** ローカル依存の強みを維持しつつ、パフォーマンスの問題を解決するため、定期的なデータクレンジング機能や、オプションとしてのプライベートクラウド環境への対応を検討する。

※記載漏れがありましたが、本アプリケーションはgitignoreにより個人情報やAPIキー含むファイルが除外されているためクローンしてそのまま実行はできません。動作画面のアップロードが完了しました。一部個人情報がわかってしまうような部分にはマスキング処理が施されています。ご了承ください。

### 8. 作成者 (Author)

本プロジェクトは、**私**と、**AIコーディングパートナー**の協働で作成しました。


-----


# 匿名通信ネットワークにおける悪性挙動分析プロジェクト

**XAI（説明可能AI）を用いて、Torに潜むマルウェアの「普遍的な振る舞い」を解明する**

## 1\. プロジェクト概要

### 背景と課題

近年、Torに代表される匿名通信ネットワークは、プライバシー保護に不可欠な技術である一方、ランサムウェアのC2（Command & Control）通信や機密情報の流出といったサイバー攻撃の温床ともなっています。通信が高度に暗-号化・匿名化されているため、従来のネットワーク監視手法ではこれらの悪性トラフィックを特定することは極めて困難です。

多くのセキュリティ研究は「未知の脅威をいかに検知するか」という課題に取り組んでいますが、その多くはAIによる判断根拠がブラックボックスであり、「なぜそれを脅威と判断したのか」を人間が理解することは困難でした。

### 本プロジェクトのアプローチ

そこで本プロジェクトでは、単に脅威を検知するだけでなく、「Torに潜む悪性通信は、どのような"普遍的な振る舞い"をするのか？」という根源的な問いに答えることを目的とします。

最新の機械学習技術と**XAI（説明可能AI）を組み合わせた独自のアプローチにより、AIの「思考プロセス」そのものを分析。そこから得られた知見を基に、人間が理解・応用可能な**「悪性挙動の特徴マップ」を定義し、最終的に検知モデルの性能を飛躍的に向上させることに成功しました。

-----

## 2\. 分析アプローチとプロセス

本研究は、データに基づき仮説を立て、AIとXAIを羅針盤としながら段階的に結論へと至る、一貫した科学的アプローチを採用しています。

### Step 1&2：可視化による初期仮説の立証

まず、倫理的配慮から実際のマルウェアは使用せず、正常なWebブラウジングと、C2通信を模倣したPythonスクリプトによるトラフィックをそれぞれ生成・収集しました。この生のトラフィックデータを可視化したところ、両者の振る舞いには一目でわかるほどの明確な違いが現れました。

| 正常なWebブラウジング (Normal Browsing) | 悪性のC2通信 (Malicious C2 Traffic) |
| :---: | :---: |
| **特徴:** 通信が**バースト状**に発生。受信データ（青）が送信（赤）を圧倒する**非対称**な構造。 | **特徴:** 通信が**周期的**に発生。送受信データ（赤・青）の量が近い**対称**な構造。 |

この可視化により、「通信の振る舞いそのものに、悪性度を判定するヒントが隠されている」という本研究の初期仮説が強力に裏付けられました。

### Step 3&4：XAIによる「AIの思考」の解明

次に、この視覚的な違いをAIが学習できるかを確認するため、パケット単位の単純な特徴（時間、パケット長など）でベースラインモデルを構築しました。結果は正解率96%と非常に高いものでしたが、本研究の目的はその先にあります。

ここで本プロジェクトの核心であるXAI (SHAP)を適用し、AIの「頭の中」を覗き見ました。その結果、AIが判断の根拠として、我々の直感と完全に一致する3つの特徴を重視していることが判明しました。

1.  **時間的周期性 (`relative_time`):** C2通信の規則的な発生タイミングを最も重要な指標として利用していました。
2.  **パケット長の均一性 (`length`):** 「巨大なパケットは正常通信の証拠」と学習し、C2通信の小さく均一なパケットサイズに着目していました。
3.  **通信の対称性 (`is_outgoing`):** 送受信のバランスから、Web閲覧の非対称性を見抜き、正常通信と判断していました。

### Step 5&6：XAIの知見に基づくモデルの進化

XAIが示してくれた上記3つの「答え」を基に、私たちは次のステップに進みました。単なるパケット単位のデータではなく、**10秒間の通信フローにおける「周期性」「均一性」「対称性」を直接計算する、より高度な特徴量**を設計しました。

この新しい特徴量で最終モデルを再訓練した結果、AIは文脈をより深く理解できるようになり、性能は劇的に向上。特に、実運用で問題となる**誤検知をゼロ**に抑えつつ、**検知率を大幅に向上させる**ことに成功しました。これは、XAIを羅針盤としてAIを改良するという、モダンな開発サイクルの有効性を示しています。

-----

## 3\. 最終的な研究成果

| 評価指標 | 初期モデル (パケット単位) | **最終モデル (フロー単位)** | 備考 |
| :--- | :---: | :---: | :--- |
| **C2 検知率 (Recall)** | 72% | **83%** | **見逃しが大幅に減少** |
| **C2 適合率 (Precision)** | 75% | **100%** | **警告の信頼性が完璧に** |
| **正常通信の誤検知** | 55件 | **0件** | **誤報（False Positive）を撲滅** |


この結果は、本研究が単なる技術実証に留まらず、セキュリティ監視の現場における「誤報疲れ」という現実的な課題を解決しうる、非常に実用的なアプローチであることを示唆しています。

-----

## 4\. 技術スタック

  * **言語:** Python 3.13
  * **通信環境:** WSL2 (Kali Linux), Tor
  * **データ収集:** Wireshark, tshark
  * **データ処理・分析:** pandas, scapy, numpy
  * **機械学習:** scikit-learn (RandomForestClassifier)
  * **XAI:** SHAP
  * **可視化:** matplotlib, seaborn
